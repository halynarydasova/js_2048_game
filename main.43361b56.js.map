{"version":3,"sources":["scripts/main.js"],"names":["score","document","querySelector","initializeGameBtn","gameOver","youWin","startMessage","rows","Array","from","querySelectorAll","board","fill","map","x","findEmptyCell","boardSize","row","column","Math","floor","random","addNumber","render","rowIdx","cell","columnIdx","elem","children","textContent","classList","setScore","startGame","cellIdx","cellArr","add","remove","contains","reduce","prev","sum","normalizeArr","move","initialArray","useReverse","normalizedArray","reverse","makeMove","newArr","moveMaded","rowInd","cellsWithData","filter","splice","length","addEventListener","pressEvent","anyMovesLeft","some","moves","includes","key","receivedArray","shift","rowArr"],"mappings":"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","file":"main.43361b56.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\n\n// write your code here\nconst score = document.querySelector('.game-score');\nconst initializeGameBtn = document.querySelector('.button.start');\nconst gameOver = document.querySelector('.message-lose');\nconst youWin = document.querySelector('.message-win');\nconst startMessage = document.querySelector('.message-start');\nconst rows = Array.from(document.querySelectorAll('.field-row'));\nconst board = Array(4).fill(0).map(x => Array(4).fill(0));\n\nfunction findEmptyCell() {\n  const boardSize = {\n    row: 0,\n    column: 0,\n  };\n\n  do {\n    boardSize.row = Math.floor(Math.random() * 4);\n    boardSize.column = Math.floor(Math.random() * 4);\n  } while (board[boardSize.row][boardSize.column] !== 0);\n\n  return boardSize;\n}\n\nfunction addNumber() {\n  const { row, column } = findEmptyCell();\n\n  board[row][column] = Math.random() < 0.9 ? 2 : 4;\n}\n\nfunction render() {\n  board.map((row, rowIdx) => {\n    row.map((cell, columnIdx) => {\n      const elem = rows[rowIdx].children[columnIdx];\n\n      if (cell === 0) {\n        elem.textContent = '';\n        elem.classList = 'field-cell';\n      } else {\n        elem.textContent = cell;\n        elem.classList = `field-cell field-cell--${cell}`;\n      }\n    });\n  });\n\n  score.textContent = setScore();\n}\n\nfunction startGame() {\n  board.map(row =>\n    row.map((cell, cellIdx, cellArr) => (\n      cellArr[cellIdx] = 0)));\n\n  render();\n  startMessage.classList.add('hidden');\n  initializeGameBtn.classList.remove('start');\n  initializeGameBtn.classList.add('restart');\n  initializeGameBtn.textContent = 'Restart';\n  score.textContent = '0';\n\n  if (!youWin.classList.contains('hidden')) {\n    youWin.classList.add('hidden');\n  }\n\n  if (!gameOver.classList.contains('hidden')) {\n    gameOver.classList.add('hidden');\n  }\n\n  addNumber();\n  addNumber();\n  render();\n}\n\nfunction setScore() {\n  return board.reduce((prev, row) => (\n    prev + row.reduce((sum, cell) => sum + cell)\n  ), 0);\n}\n\nfunction normalizeArr(move, initialArray, useReverse = false) {\n  const normalizedArray = [[], [], [], []];\n\n  if (move === 'ArrowUp' || move === 'ArrowDown') {\n    for (let row = 0; row < 4; row++) {\n      for (let column = 0; column < 4; column++) {\n        normalizedArray[column][row] = initialArray[row][column];\n      }\n    }\n  }\n\n  if (move === 'ArrowLeft' || move === 'ArrowRight') {\n    for (let row = 0; row < 4; row++) {\n      for (let column = 0; column < 4; column++) {\n        normalizedArray[row][column] = initialArray[row][column];\n      }\n    }\n  }\n\n  if (useReverse && (move === 'ArrowRight' || move === 'ArrowDown')) {\n    normalizedArray.map(row => row.reverse());\n  }\n\n  return normalizedArray;\n}\n\nfunction makeMove(move) {\n  const newArr = normalizeArr(move, board, true);\n  let moveMaded = false;\n\n  newArr.map((row, rowInd) => {\n    const cellsWithData = row.filter(cell => cell !== 0);\n\n    cellsWithData.map((cell, cellIdx, cellArr) => {\n      if (cell === cellArr[cellIdx + 1]) {\n        cellArr[cellIdx] *= 2;\n        cellArr.splice(cellIdx + 1, 1);\n        moveMaded = true;\n      }\n    });\n    moveMaded = moveMaded || cellsWithData.length !== 4;\n\n    row.map((cell, cellIdx, cellArr) => {\n      cellArr[cellIdx] = cellsWithData[cellIdx] || 0;\n    });\n  });\n\n  if (!moveMaded) {\n    return false;\n  }\n\n  if (move === 'ArrowRight' || move === 'ArrowDown') {\n    newArr.map(row => row.reverse());\n  }\n\n  return normalizeArr(move, newArr);\n}\n\ninitializeGameBtn.addEventListener('click', startGame);\n\ndocument.addEventListener('keydown', (pressEvent) => {\n  let anyMovesLeft = board.some(row => row.some(cell => cell === 0));\n  const moves = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'];\n\n  const move = moves.includes(pressEvent.key) ? pressEvent.key : '';\n  let receivedArray = [];\n\n  if (move) {\n    receivedArray = makeMove(move);\n\n    if (!receivedArray || !anyMovesLeft) {\n      anyMovesLeft = moves.some(shift => {\n        if (move === shift) {\n          return false;\n        }\n\n        return !!makeMove(shift);\n      });\n    }\n\n    if (!anyMovesLeft) {\n      gameOver.classList.remove('hidden');\n    }\n\n    if (receivedArray) {\n      board.map((row, rowIdx, rowArr) => {\n        row.map((cell, columnIdx) => {\n          rowArr[rowIdx][columnIdx] = receivedArray[rowIdx][columnIdx];\n        });\n      });\n\n      if (board.some(row => row.some(cell => cell === 2048))) {\n        youWin.classList.remove('hidden');\n      }\n\n      addNumber();\n      render();\n    }\n  }\n});\n"]}